// ==UserScript==
// @name         Krunker.io Public ESP Hack
// @description  Krunker.io ESP Hack
// @updateURL    https://github.com/xF4b3r/krunker/raw/master/alternative.user.js
// @downloadURL  https://github.com/xF4b3r/krunker/raw/master/alternative.user.js
// @version      1.5
// @author       Faber
// @match        *://krunker.io/*
// @grant        GM_xmlhttpRequest
// @run-at       document-start
// ==/UserScript==

stop(),document.innerHTML="";function setHooks(i){return i={canvas:null,ctx:null,hooks:{entities:[],world:null},getDistance3D:function(j,k,l,m,n,o){return j-=m,k-=n,l-=o,Math.sqrt(j*j+k*k+l*l)},createCanvas:function(){var j=document.createElement("canvas");j.id="hookedcv",j.width=innerWidth,j.height=innerHeight,window.onresize=function(){j.width=innerWidth,j.height=innerHeight},this.canvas=j,this.ctx=j.getContext("2d"),document.getElementById("inGameUI").insertAdjacentElement("beforeend",j),requestAnimationFrame(this.render.bind(this))},drawText:function(j,k,l,m,n){this.ctx.save(),this.ctx.translate(m,n),this.ctx.beginPath(),this.ctx.fillStyle=l,this.ctx.font=k,this.ctx.fillText(j,0,0),this.ctx.closePath(),this.ctx.restore()},getMyself:function(){return this.hooks.entities.find(function(j){return j.isYou})},drawESP:function(){for(var j=$jscomp.makeIterator(this.hooks.entities.filter(function(r){return!r.isYou})),k=j.next();!k.done;k=j.next())if(k=k.value,k.active){var l=this.hooks.world.camera.getWorldPosition(),m=k.objInstances.position.clone();if(1<=20*(1-this.getDistance3D(l.x,l.y,l.z,m.x,m.y,m.z)/600)&&this.hooks.world.frustum.containsPoint(m)){var n=Math.max(.1,1-this.getDistance3D(l.x,l.y,l.z,m.x,m.y,m.z)/600),o=k.hookedX,p=k.hookedY+60*n;this.ctx.save(),this.ctx.translate(o-80*n/2-40*n/2,p-180*n/2),this.ctx.beginPath(),this.ctx.fillStyle="red",this.ctx.rect(0,0,20*n,180*n),this.ctx.stroke(),this.ctx.closePath(),this.ctx.restore(),this.ctx.save(),this.ctx.translate(o-80*n/2-40*n/2,p-180*n/2),this.ctx.beginPath(),this.ctx.fillStyle="green",this.ctx.rect(0,0,20*n,180*n),this.ctx.fill(),this.ctx.closePath(),this.ctx.restore(),this.ctx.save(),this.ctx.translate(o-80*n/2-40*n/2,p-180*n/2),this.ctx.beginPath(),this.ctx.fillStyle="red",this.ctx.rect(0,0,20*n,180*((k.maxHealth-k.health)/k.maxHealth)*n),this.ctx.fill(),this.ctx.closePath(),this.ctx.restore(),this.ctx.save(),this.ctx.translate(o-80*n/2,p-180*n/2),this.ctx.beginPath(),this.ctx.fillStyle="red",this.ctx.rect(0,0,80*n,180*n),this.ctx.stroke(),this.ctx.closePath(),this.ctx.restore();var q=13<26*n?13:26*n;this.drawText("Name: "+k.name,q+"px","green",o+80*n/2,p-180*n/2),this.drawText("Distance: "+~~this.getDistance3D(l.x,l.y,l.z,m.x,m.y,m.z),q+"px","green",o+80*n/2,p-180*n/2+10),this.drawText("Health: "+k.health+"/"+k.maxHealth,q+"px","green",o+80*n/2,p-180*n/2+20),this.drawText("Weapon: "+k.weapon.name,q+"px","green",o+80*n/2,p-180*n/2+30),this.drawText("Ammo: "+k.ammos[0],q+"px","green",o+80*n/2,p-180*n/2+40),this.ctx.save(),this.ctx.lineWidth=2,this.ctx.strokeStyle=null===k.team?"red":this.getMyself().team===k.team?"green":"red",this.ctx.moveTo(innerWidth/2,innerHeight-1),this.ctx.lineTo(o,p),this.ctx.stroke(),this.ctx.restore()}}},render:function(){this.ctx.clearRect(0,0,innerWidth,innerHeight),this.drawESP(),requestAnimationFrame(this.render.bind(this))},onLoad:function(){window.$jscomp={},$jscomp.scope={},$jscomp.arrayIteratorImpl=function(j){var k=0;return function(){return k<j.length?{done:!1,value:j[k++]}:{done:!0}}},$jscomp.arrayIterator=function(j){return{next:$jscomp.arrayIteratorImpl(j)}},$jscomp.makeIterator=function(j){var k="undefined"!=typeof Symbol&&Symbol.iterator&&j[Symbol.iterator];return k?k.call(j):$jscomp.arrayIterator(j)},window.playerInfos.style.width="0%",i.createCanvas()}},i.onLoad(),i}GM_xmlhttpRequest({method:"GET",url:"https://krunker.io/js/game.js",onload:function(i){var j=i.responseText;j=j.replace(/String\.prototype\.escape=function\(\){(.*)\)},(Number\.)/,"$2").replace(/if\(\w+\.notObstructed\){/,"").replace(/}else \w+\.style\.display="none"/,"").replace(/(\bthis\.list\b)/g,"window.hack.hooks.entities").replace(/\w+\.players\.list/g,"window.hack.hooks.entities").replace(/(function\(\w+,(\w+),\w+,\w+,\w+,\w+,\w+\){var \w+,\w+,\w+;window\.hack\.hooks\.entities=\[\];)/,"$1window.hack.hooks.world=$2;").replace(/(\w+\.style\.left=)100\*(\w+\.\w+)\+"%",/,"$1$2*innerWidth+\"px\",window.hack.hooks.entities[i].hookedX=$2*innerWidth,").replace(/(\w+\.style\.top=)100\*\(1-(\w+\.\w+)\)\+"%",/,"$1(1-$2)*innerHeight+\"px\",window.hack.hooks.entities[i].hookedY=(1-$2)*innerHeight,"),GM_xmlhttpRequest({method:"GET",url:"https://krunker.io/",onload:function(k){k=k.responseText,k=k.replace(" src=\"js/game.js\">",">"+setHooks.toString()+"\nwindow.hack = setHooks({})\n"+j.toString()),document.open(),document.write(k),document.close()}})}});
